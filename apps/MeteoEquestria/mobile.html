<!DOCTYPE html>
<html>
	<!-- HEAD BEGIN -->
	<head>
		<meta charset="utf-8"/>
		
		<!-- Viewport -->
		<meta name="HandheldFriendly" content="True">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-title" content="Meteo Equestria">
		
		<!-- Status bar styles -->
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
		
		<!-- Telephone format detection -->
		<meta name="format-detection" content="telephone=no">
		
		<!-- iPhone 4/4S SPLASHSCREEN -->
        <link href="./startupimages/640x960.png" media="(device-width: 320px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
		<!-- iPhone 5/5S/SE SPLASHSCREEN -->
		<link href="./startupimages/640x1136.png" media="(device-width: 320px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
		<!-- iPhone 6/6S/7/8 SPLASHSCREEN -->
        <link href="./startupimages/750x1334.png" media="(device-width: 375px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
        <!-- iPhone 6/6S/7/8 Plus SPLASHSCREEN -->
        <link href="./startupimages/1242x2208.png" media="(device-width: 414px) and (-webkit-device-pixel-ratio: 3)" rel="apple-touch-startup-image">
        <!-- iPhone X SPLASHSCREEN -->
        <link href="./startupimages/1125x2436.png" media="(device-width: 375px) and (-webkit-device-pixel-ratio: 3)" rel="apple-touch-startup-image">
		<!-- iPhone SPLASHSCREEN-->
        <!-- <link href="./startupimages/320x460.png" media="(device-width: 320px)" rel="apple-touch-startup-image"> -->
        <!-- iPhone 4/4S (Retina) SPLASHSCREEN-->
        <!-- <link href="./startupimages/640x920.png" media="(device-width: 320px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image"> -->
        <!-- iPad (portrait) SPLASHSCREEN-->
        <!-- <link href="./startupimages/768x1004.png" media="(device-width: 768px) and (orientation: portrait)" rel="apple-touch-startup-image"> -->
        <!-- iPad (landscape) SPLASHSCREEN-->
        <!-- <link href="./startupimages/748x1024.png" media="(device-width: 768px) and (orientation: landscape)" rel="apple-touch-startup-image"> -->
        <!-- iPad (Retina, portrait) SPLASHSCREEN-->
        <!-- <link href="./startupimages/1536x2008.png" media="(device-width: 1536px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image"> -->
        <!-- iPad (Retina, landscape) SPLASHSCREEN-->
        <!-- <link href="./startupimages/2048x1496.png" media="(device-width: 1536px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image"> -->
		
		<!-- iOS app icons -->
		<link rel="apple-touch-icon-precomposed" sizes="76x76" href="./icons/76.png"><!-- iPad 2, iPad mini -->
		<link rel="apple-touch-icon-precomposed" sizes="120x120" href="./icons/120.png"><!-- iPhone 6s, iPhone 6, iPhone 5 -->
		<link rel="apple-touch-icon-precomposed" sizes="152x152" href="./icons/152.png"><!-- iPad, iPad mini -->
		<link rel="apple-touch-icon-precomposed" sizes="167x167" href="./icons/167.png"><!-- iPad Pro -->
		<link rel="apple-touch-icon-precomposed" sizes="180x180" href="./icons/180.png"><!-- iPhone 6s Plus, iPhone 6 Plus -->
		<link rel="apple-touch-icon-precomposed" sizes="1024x1024" href="./icons/1024.png">
		
		<!-- Path to library CSS -->
		<link href="./styles/mobile.css" rel="stylesheet">
		
		<!-- Path to scripts library -->
		<script src="./scripts/ismobile.js" type="text/javascript"></script>
		<script src="./scripts/MeteoEquestria.js" type="text/javascript"></script>
		<script src="./scripts/scrollfix.js" type="text/javascript"></script>
		<script src="./scripts/fastclick2.js" type="application/javascript"></script>
		<script src="./scripts/weather_parser.js" charset="utf-8" type="text/javascript"></script>
		
		<script type="text/javascript">
			/*if(isMobile() === false) {
				window.location  = "index.html";
			}*/	
			
			function str_replace(search, replace, subject) {
				return subject.split(search).join(replace);
			}
			
		</script>
	</head>
	<!-- HEAD END -->
	
	<body>
<!-- 		<div id="loading-screen"></div> -->
		<div class="screen-rounder-top-left"></div>
		<div class="screen-rounder-top-right"></div>
		<div class="screen-rounder-bottom-right"></div>
		<div class="screen-rounder-bottom-left"></div>

		<!-- MAIN SCREENS BEGIN -->
		<div id="main-screen">
			<!-- PORTRAIT SCREEN BEGIN -->
			<!-- <div class="status-bar"></div> -->

			<div id="main-screen-content" class="noBounce">
				<div id="bg-overlay"></div>
				<div class="scrollfix-content">
					
					<div id="today-tab">
						<div class="today-location"><span class="city">Ponyville</span>, <span class="country">Equestria</span></div>
						<div><span class="today-day">Monday</span> <span class="today-date">XX</span></div>
						<div><span class="today-temperature">±XX</span></div>
						<div class="today-icon"></div>
					</div>
					
					<ul id="tabs">
						
						<li class="tab" num="1">
							<div class="tab-heading">
								<div class="tab-icon"></div>
								<span class="tab-day">Tue</span>
								<span class="tab-date">XX</span>
							</div>
							<div class="tab-temperature">±XX<sup>°C</sup></div>
						</li>
						
						<li class="tab" num="2">
							<div class="tab-heading">
								<div class="tab-icon"></div>
								<span class="tab-day">Wed</span>
								<span class="tab-date">XX</span>
							</div>
							<div class="tab-temperature">±XX<sup>°C</sup></div>
						</li>
						
						<li class="tab" num="3">
							<div class="tab-heading">
								<div class="tab-icon"></div>
								<span class="tab-day">Thu</span>
								<span class="tab-date">XX</span>
							</div>
							<div class="tab-temperature">±XX<sup>°C</sup></div>
						</li>
						
						<li class="tab" num="4">
							<div class="tab-heading">
								<div class="tab-icon"></div>
								<span class="tab-day">Fri</span> 
								<span class="tab-date">XX</span>
							</div>
							<div class="tab-temperature">±XX<sup>°C</sup></div>
						</li>
						
						<li class="tab" num="5">
							<div class="tab-heading">
								<div class="tab-icon"></div>
								<span class="tab-day">Sat</span>
								<span class="tab-date">XX</span>
							</div>
							<div class="tab-temperature">±XX<sup>°C</sup></div>
						</li>
						
						<li class="tab" num="6">
							<div class="tab-heading">
								<div class="tab-icon"></div>
								<span class="tab-day">Sun</span>
								<span class="tab-date">XX</span>
							</div>
							<div class="tab-temperature">±XX<sup>°C</sup></div>
						</li>
						
						<li class="tab" num="7">
							<div class="tab-heading">
								<div class="tab-icon"></div>
								<span class="tab-day">Sun</span>
								<span class="tab-date">XX</span>
							</div>
							<div class="tab-temperature">±XX<sup>°C</sup></div>
						</li>

					</ul>
				</div>
			</div>

			<div class="nav-bar">
				<div class="nav-button" onclick="showScreen('search', true)"><img src="./img/search.svg"/></div>
				<div class="nav-button" onclick="showScreen('favorite', false), loadFavorite()"><img src="./img/favorites.svg"/></div>
				<div class="nav-button" onclick=""><img src="./img/location.svg"/></div>
				<div class="nav-button" onclick="showScreen('settings', true)"><img src="./img/gear.svg"/></div>
			</div>
			<!-- PORTRAIT SCREEN END -->
						
		</div>
		<!-- MAIN SCREENS END -->
		
		<!-- SETTINGS SCREEN BEGIN -->
		<div id="settings-screen">
			<div class="head noBounce" align="center">
				<span class="title">Settings</span>
				<span class="button-right" onclick="hideScreen('settings', false); initiate();">Done</span>
			</div>
			<div id="settings-screen-content">
			<div class="scrollfix-content">
				<div class="blank">
					<h2>Meteo Equestria</h2>
					<div class="logo" align="center"></div>
					<br>
					version 0.5
				</div>
				<ul class="ios-ul">
					<li class="ios-li glyphIcon reload">
						<div onclick="initiate(); hideScreen('settings', true);">Refresh weather data</div>
					</li>
					<li class="ios-li glyphIcon reset">
						<div onclick="resetSettings()">Reset all settings to default</div>
					</li>
				</ul>
				<div class="ios-ul-title">customisation</div>
				<script>
					function toggle( tumbler ) {
						if (tumbler.checked == false) {
					        tumbler.checked = true; 
					    }
					    else {
					        if (tumbler.checked == true) {
					        	tumbler.checked = false; 
					        }   
					    }
					}
				</script>
				<ul class="ios-ul">
					<li class="ios-li">
						<div onclick="toggle(this.querySelector('input')); checkSettings()">
							Show weather icons
							<label id="showIcons-switch" class="ios7-switch">
								<input type="checkbox">
								<span></span>
							</label>
						</div>
					</li>
					<li class="ios-li">
						<div onclick="toggle(this.querySelector('input')); checkSettings()">
							Weeakday name shortify
							<label id="shortify-switch" class="ios7-switch">
								<input type="checkbox">
								<span></span>
							</label>
						</div>
					</li>
					<li class="ios-li">
						<div onclick="toggle(this.querySelector('input')); checkSettings()" class="">
							Use white theme
							<label id="whiteTheme-switch" class="ios7-switch">
								<input type="checkbox">
								<span></span>
							</label>
						</div>
					</li>
					<li class="ios-li">
						<div onclick="toggle(this.querySelector('input')); checkSettings()">
							Tabs color highlighting
							<label id="showColors-switch" class="ios7-switch">
								<input type="checkbox">
								<span></span>
							</label>
						</div>
					</li>
				</ul>
				<div class="hint">This setting turning on/off the weather tabs color highlighting depending to the temperature</div>
				<div class="ios-ul-title">contact information</div>
				<ul class="ios-ul">
					<li class="ios-li glyphIcon gmail">
						<div onclick="window.open('mailto:stavrapid@mail.ru')">Send Feedback</div>
					</li>
					<li class="ios-li glyphIcon star">
						<div class="disabled">Rate this App</div>
					</li>
					<li class="ios-li glyphIcon site">
						<div onclick="clickLink(this.querySelector('a'))">Visit my Site<a href="http://stavrapid.ru" target="_blank"></a></div>
					</li>
					<!-- <li class="ios-li glyphIcon vk">
						<div onclick="clickLink(this.querySelector('a'))">Follow me on VK<a href="https://vk.com/stavrapid.lair" target="_blank"></a></div>
					</li> -->
					<li class="ios-li glyphIcon twitter">
						<div onclick="clickLink(this.querySelector('a'))">Follow me on Twitter<a href="https://twitter.com/stavrapid" target="_blank"></a></div>
					</li>
					<li class="ios-li glyphIcon facebook">
						<div onclick="clickLink(this.querySelector('a'))">Follow me on Facebook<a href="https://facebook.com/stavrapid" target="_blank"></a></div>
					</li>
					<!-- <li class="ios-li glyphIcon instagram">
						<div onclick="clickLink(this.querySelector('a'))">Follow me on Instagram<a href="https://instagram.com/stavrapid" target="_blank"></a></div>
					</li> -->
					<!-- <li class="ios-li glyphIcon youtube">
						<div onclick="clickLink(this.querySelector('a'))">Follow me on YouTube<a href="https://www.youtube.com/channel/UCvCDCx_FuzKNHSp7qDZWipg" target="_blank"></a></div>
					</li> -->
					<!-- <li class="ios-li glyphIcon soundcloud">
						<div onclick="clickLink(this.querySelector('a'))">Follow me on SoundCloud<a href="https://soundcloud.com/stavrapid" target="_blank"></a></div>
					</li> -->
					<li class="ios-li glyphIcon telegram">
						<div onclick="window.open('#')">Follow me on Telegram</div>
					</li>
				</ul>
				<div class="blank">
					All meteo data provided by <a href="#">Cloudsdale Weather Patrol</a>
				</div>
			</div>
			</div>
		</div>
		<!-- SETTINGS SCREEN END -->
		
		<!-- SEARCH SCREEN BEGIN -->
		<div id="search-screen">
			<div class="head noBounce" align="center">
				<span class="button-right" onclick="hideScreen('search', false);">Cancel</span>
				<span class="title">Location</span>
				<div class="search-field-container">
					<div class="reset-button" onclick="searchInputReset(this, 'search-screen')"><img src="./img/ios-cross.svg"/></div>
					<input type="text" name="" class="search-field" placeholder="Search" oninput="searchInputChanged(this, 'search-screen')" disabled>
				</div>
			</div>
			<div id="search-screen-content">
			<div class="scrollfix-content">
				<div class="ios-ul-title">Crystal Empire</div>
				<ul class="ios-ul">
					<li class="ios-li">
						<div onclick="setLocation('Crystal Empire City', 'Crystal Empire');">Crystal Empire City</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Crystal Mountains','Crystal Empire');">Crystal Mountains</div>
					</li>
				</ul>
				<div class="ios-ul-title">Equestria</div>
				<ul class="ios-ul">
					<li class="ios-li">
						<div onclick="setLocation('Appleloosa','Equestria');">Appleloosa</div>
					</li>
					<li class="ios-li">
						<div onclick="setLocation('Canterlot','Equestria');">Canterlot</div>
					</li>
					<li class="ios-li">
						<div onclick="setLocation('Cloudsdale','Equestria');">Cloudsdale</div>
					</li>
					<li class="ios-li">
						<div onclick="setLocation('Everfree Forest','Equestria');">Everfree Forest</div>
					</li>
					<li class="ios-li">
						<div onclick="setLocation('Las Pegasus','Equestria');">Las Pegasus</div>
					</li>
					<li class="ios-li">
						<div onclick="setLocation('Manehatten','Equestria');">Manehatten</div>
					</li>
					<li class="ios-li">
						<div onclick="setLocation('Ponyville','Equestria');">Ponyville</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">Vanhoover</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">Saddle Lake</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">White Tail Woods</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Froggy Bottom Bogg','Equestria');">Froggy Bottom Bogg</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">Rockville</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Ghastly Gorge','Equestria');">Ghastly Gorge</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">Dodge Junction</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">Dragon Lands</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">Frozen North</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Winsome Falls','Equestria');">Winsome Falls</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">Tenochtitlan Basin</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Rainbow Falls','Equestria');">Rainbow Falls</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">Fillydelphia</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">Applewood</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">Baltimare</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Hollow Shades','Equestria');">Hollow Shades</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">Ponhenge</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Smokey Mountains','Equestria');">Smokey Mountains</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Badlands','Equestria');">Badlands</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Breezie Village','Equestria');">Breezie Village</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Tartarus','Equestria');">Tartarus</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Neighagra Falls','Equestria');">Neighagra Falls</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Our Town','Equestria');">Our Town</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">Sire's Hollow</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">Seaward Shoals</div>
					</li>
					<li class="ios-li">
						<div  class="disabled" onclick="setLocation('','');">Stratusburg</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Somnambula','Equestria');">Somnambula</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Hayseed Swamp','Equestria');">Hayseed Swamp</div>
					</li>
				</ul>
				<div class="ios-ul-title">Beyond Equestria</div>
				<ul class="ios-ul">
					<li class="ios-li">
						<div  class="" onclick="setLocation('Maretropolis','Beyond Equestria');">Maretropolis</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Griffonstone','Beyond Equestria');">Griffonstone</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Yakyakistan','Beyond Equestria');">Yakyakistan</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Chaosville','Beyond Equestria');">Chaosville</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Changeling Kingdom','Beyond Equestria');">Changeling Kingdom</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Klugetown','Beyond Equestria');">Klugetown</div>
					</li>
					<li class="ios-li">
						<div  class="" onclick="setLocation('Seaquestria','Beyond Equestria');">Seaquestria</div>
					</li>
				</ul>
			</div>
			</div>
		</div>
		<!-- SEARCH SCREEN END -->
		
		<!-- FAVORITE SCREEN BEGIN -->
		<div id="favorite-screen">
			<div class="head noBounce" align="center">
				<span class="title">Favorite</span>
				<span class="button-left" onclick="showScreen('favorite', true);"><img src="./img/plus.svg"></span>
				<span class="button-right" onclick="hideScreen('favorite', false);">Cancel</span>
				<!-- <div class="search-field-container">
					<div class="reset-button" onclick="searchInputReset(this, 'favorite-screen')"></div>
					<input type="text" name="" class="search-field" placeholder="Search" oninput="searchInputChanged(this, 'favorite-screen')" disabled>
				</div> -->
			</div>
			<div id="favorite-screen-content">
			<div class="scrollfix-content">
				
			</div>
			</div>
		</div>
		<!-- FAVORITE SCREEN END -->

		<!-- MAIN SCRIPTS BEGIN-->
		<script type="text/javascript">
			
			cache = window.applicationCache;
			if (window.applicationCache.status == window.applicationCache.UPDATEREADY) {
				window.applicationCache.update();
				window.applicationCache.swapCache();
			}

			// LOCAL STORAGE SETTINGS BEGIN
			function resetSettings() {	
				localStorage.setting_showIcons = "true",
				localStorage.setting_shortify = "true",
				localStorage.setting_whiteTheme = "true",
				localStorage.setting_showColors = "false",
				localStorage.setting_town = "Changeling Kingdom",
				localStorage.setting_country = "Beyond Equestria",
				localStorage.setting_units = "Celsius";
				localStorage.favorite = '[["Changeling Kingdom", "Beyond Equestria"],["Crystal Empire City", "Crystal Empire"],["Cloudsdale", "Equestria"],["Ponyville", "Equestria"],["Manehatten", "Equestria"]]';
				loadInterface();
				checkSettings();
			}
			if (localStorage.setting_showColors == undefined) {
				console.log('Local Storage is empty. Setting up default settings.');
				resetSettings();
			}
			// LOCAL STORAGE SETTINGS END

			// APP SETTINGS BEGIN
			// var setting_showColors = true,
			// 	setting_showIcons = true,
			// 	setting_shortify = true,
			// 	setting_town = "Changeling Kingdom",
			// 	setting_country = "Beyond Equestria",
			// 	setting_units = "Celsius";
			// APP SETTINGS END
			
			// Add Fastclick
			window.addEventListener("load", function() {
				FastClick.attach(document.body);
			}, false);
			
			// Fake click on links
			function clickLink( link ) {
				console.log(link);
				link.click();
				link.click();
			}

			// Search Field Input Changed
			function searchInputChanged( field, screen ) {
				if ( field.value == '' ) {
					field.parentNode.getElementsByClassName('reset-button')[0].style.display = 'none';
				} else {
					field.parentNode.getElementsByClassName('reset-button')[0].style.display = 'block';
				}
				search( field.value, screen );
			}

			// Search Input Reset
			function searchInputReset( button, screen ) {
				button.parentNode.getElementsByTagName('input')[0].value = '';
				searchInputChanged( button.parentNode.getElementsByTagName('input')[0], screen );
			}

			// Searching Algoritm
			function search( filter, screen ) {
				var list = document.getElementById( screen + '-content' );
				var lUl = list.getElementsByTagName( 'ul' );
				var gotit = false;
				for ( i = 0; i < lUl.length; i++ ) {
					gotit = false;
					var lLi = lUl[ i ].getElementsByTagName( 'li' );
					for ( var j = 0; j < lLi.length; j++ ) {
						if ( lLi[ j ] ) {
							if ( lLi[ j ].textContent.replace(/\u00A0+/g,'').toUpperCase().indexOf( filter.toUpperCase() ) > -1 ) {
								gotit = true;
								lLi[ j ].style.display = '';
								lLi[ j ].classList.remove( 'filter-li-hidden' );
								// break;
							} else {
								// gotit = false;
								lLi[ j ].style.display = 'none';
								lLi[ j ].classList.add( 'filter-li-hidden' );
							}
						}
					}
					if ( gotit ) {
						list.getElementsByClassName('ios-ul-title')[ i ].style.display = '';
					} else {
						list.getElementsByClassName('ios-ul-title')[ i ].style.display = 'none';
					}
					gotit = false;
				}
				// if ( list.querySelectorAll( 'li:not(.filter-li-hidden)' ).length == 0 ) {
				// 	document.getElementById( 'table_messager' ).innerHTML = 'По запросу <span>' + filter.toUpperCase() + '</span> ничего не найдено';
				// } else {
				// 	document.getElementById( 'table_messager' ).innerHTML = '';
				// }
			}
			// FAVORITES CODE BEGIN
			// [["location","country"],["location","country"],["location","country"]]
			function loadFavorite() {
				if ( localStorage.favorite != undefined ) {
					var favScreen = document.getElementById('favorite-screen'),
						favs = JSON.parse(localStorage.favorite),
						container = favScreen.getElementsByClassName('scrollfix-content')[0],
						favTitle = document.createElement( 'div' ),
						ulBlank = document.createElement( 'ul' );

					container.innerHTML = ''; //clean favorite screen

					favTitle.className = 'ios-ul-title';
					favTitle.innerHTML = 'Favorite locations';
					ulBlank.className = 'ios-ul';
					container.appendChild( favTitle );
					container.appendChild( ulBlank );
					for (var i = 0; i < favs.length; i++) {
						var liBlank = document.createElement( 'li' );
						liBlank.className = 'ios-li';
						liBlank.innerHTML = '<div onclick="setLocation(\'' + favs[i][0] + '\',\'' + favs[i][1] + '\');">' + favs[i][0] + '</div>';
						ulBlank.appendChild( liBlank );
					}
				} else {
					console.log('Favorites is undefined');
				}
			}

			function saveFavorite( location, country ) {
				var favArray = JSON.parse(localStorage.favorite),
					favPlace = ['',''];

				favPlace[0] = location;
				favPlace[1] = country;
				favArray.push( favPlace );
				localStorage.favorite = JSON.stringify(favArray);
			}
			// FAVORITES CODE END

			// SHOW/HIDE SCREEN BEGIN
			function showScreen(screenName, scrollTop){
				var screen = document.getElementById(screenName + "-screen");
				if ( scrollTop ) {
					screen.querySelector(".scrollfix-content").scrollTop = 1;
				}
				screen.setAttribute("style", "-webkit-transform: translate3d(0, -100%, 0); -moz-transform: translate3d(0, -100%, 0);");
				// document.getElementById('main-screen').style.webkitTransform = 'scale3d(0.95,0.95,0.95)';
				document.getElementById('main-screen').setAttribute("style", "-webkit-transform: scale3d(0.95,0.95,0.95);");
				if ( screen.querySelector('.search-field') != null ) {
					screen.querySelector('.search-field').disabled = "";
				}
			}
			
			function hideScreen(screenName, scrollTop) {
				if ( scrollTop ) {
					document.getElementById("main-screen").querySelector(".scrollfix-content").scrollTop = 1;
				}
				var screen = document.getElementById(screenName + "-screen");
				screen.setAttribute("style", "-webkit-transform: translate3d(0, 0, 0);");
				// document.getElementById('main-screen').style.webkitTransform = 'scale3d(1,1,1)';
				document.getElementById('main-screen').setAttribute("style", "-webkit-transform: scale3d(1,1,1);");
				if ( screen.querySelector('.search-field') != null ) {
					screen.querySelector('.search-field').disabled = "disabled";
				}
			}
			// SHOW/HIDE SCREEN END
			
			function setLocation(town, country) {
				
				localStorage.setting_town = town;
				localStorage.setting_country = country;
				
				initiate();
				window.setTimeout(function(){
					hideScreen("search", true);
					hideScreen("favorite", true);
				}, 100);
			}
			
			// Scrollfix stuff BEGIN
			document.addEventListener("touchmove", function(event) {
				//document.querySelector(".today-temperature").innerHTML = document.getElementById("content").scrollTop;
				
				if(event.target.parentNode.className.indexOf("noBounce") != -1 || event.target.className.indexOf("noBounce") != -1 ) {
					event.preventDefault();
				}
			}, false);
			
			// Add ScrollFix
			var scrollingContent = document.getElementsByClassName("scrollfix-content");
			for (j=0; j<scrollingContent.length; j++) {
				scrollingContent[j].scrollTop = 1;
				new ScrollFix(scrollingContent[j]);
			}
			// Scrollfix stuff END

			loadInterface();
			initiate();
			// Clock();
			
			window.addEventListener("orientationchange", function() {
				if (window.orientation != 0) {
					//landscape
				} else {
					//portrait
				}
			}, false);
			
			// Background stretch BEGIN
			// document.querySelector("#main-screen").addEventListener("scroll", function(e){
			// 	var screen = document.querySelector("#main-screen");
			// 	if (screen.scrollTop < 1) {
			// 		document.querySelector("body").setAttribute("style", "background-size: " + (100 - (screen.scrollTop * 0.65)) + "% !important;");
			// 	}
			// 	if (screen.scrollTop > 1) {
			// 		document.querySelector("body").setAttribute("style", "background-size: 100% !important;");
			// 		console.log(screen.scrollTop);
			// 	}
			// });
			
			document.getElementById("main-screen").querySelector(".scrollfix-content").addEventListener("scroll", function(e){
				var screen = document.getElementById("main-screen-content").querySelector(".scrollfix-content");
				var scrollBottom = (screen.scrollHeight - (screen.offsetHeight + screen.scrollTop));
				var mainScreenContent = document.getElementById("main-screen-content");
				var lastTab = mainScreenContent.getElementsByClassName("tab")[ mainScreenContent.getElementsByClassName("tab").length - 1 ];

				// document.getElementById("main-screen-content").querySelector(".today-temperature").innerHTML = scrollBottom;
				if (screen.scrollTop > 1 && scrollBottom >= 1) {
					// document.getElementById('today-tab').style.marginBottom = "-" + (10 + screen.scrollTop * 0.5) + "px";
					document.getElementById('today-tab').style.webkitTransform = 'translate3d(0,' + (screen.scrollTop * 0.4) + 'px, 0)';
					// document.getElementById('today-tab').style.opacity = ( 1 - screen.scrollTop * 0.01 );
					document.getElementById('bg-overlay').style.opacity = ( screen.scrollTop * 0.01 );
					// document.getElementById('today-tab').setAttribute('style', '-webkit-backdrop-filter: saturate(' + (100 + screen.scrollTop * 0.4) + '%) blur(' + (screen.scrollTop * 0.15) + 'px)');
					// document.getElementById('tabs').style.boxShadow = 'rgba(0, 0, 0, ' + (0.3 - screen.scrollTop * 0.002) + ') 0px 0px 25px 5px';
				}
				
				if ( scrollBottom <= lastTab.offsetHeight / 2 ) {
					// mainScreenContent.style.backgroundColor = window.getComputedStyle( lastTab ,null).getPropertyValue('background-color');
				} else {			
					// mainScreenContent.style.backgroundColor = '';
				}
				if (screen.scrollTop <= 1) {
					// document.getElementById('today-tab').style.webkitTransform = "";
					document.getElementById('today-tab').style.webkitTransform = 'translate3d(0,0,0)';
					// document.getElementById('today-tab').style.opacity = '1';
					document.getElementById('bg-overlay').style.opacity = '';	
				}
			});
			
			// Background stretch END
			
			function tumbler( tumblerId ) {
				return document.getElementById( tumblerId ).querySelector("input[type='checkbox']");
			}

			function parseBoolean(string) {
				var bool;
				bool = (function() {
					switch (false) {
						case string.toLowerCase() !== 'true':
							return true;
			    		case string.toLowerCase() !== 'false':
			    			return false;
			    	}
			  	})();
			  	if (typeof bool === "boolean") {
			    	return bool;
		  		}
				return void 0;
			};

			function loadInterface() {
				// Tumblers
				loadFavorite();
				console.log('Loading Interface');
				tumbler("showIcons-switch").checked = parseBoolean(localStorage.setting_showIcons);
				tumbler("shortify-switch").checked = parseBoolean(localStorage.setting_shortify);
				tumbler("whiteTheme-switch").checked = parseBoolean(localStorage.setting_whiteTheme);
				tumbler("showColors-switch").checked = parseBoolean(localStorage.setting_showColors);
				console.log(tumbler("showIcons-switch").checked);
				console.log(tumbler("shortify-switch").checked);
				console.log(tumbler("whiteTheme-switch").checked);
				console.log(tumbler("showColors-switch").checked);
			}

			function saveSettings() {
				// Tumblers
				if ( tumbler("showIcons-switch").checked == true ) {
					localStorage.setting_showIcons = "true";
				} else {
					localStorage.setting_showIcons = "false";
				}
				if ( tumbler("shortify-switch").checked == true ) {
					localStorage.setting_shortify = "true";
				} else {
					localStorage.setting_shortify = "false";
				}
				if ( tumbler("whiteTheme-switch").checked == true ) {
					localStorage.setting_whiteTheme = "true";
				} else {
					localStorage.setting_whiteTheme = "false";
				}
				if ( tumbler("showColors-switch").checked == true ) {
					localStorage.setting_showColors = "true";
				} else {
					localStorage.setting_showColors = "false";
				}

				console.log('SETTINGS SAVED BEGIN');
				console.log(localStorage);
				console.log('SETTINGS SAVED END');
			}

			function checkSettings() {
				saveSettings();
				if ( localStorage.setting_showColors == "false" ) {
					document.getElementById("tabs").classList.remove('colored');
					for (i = 0; i < document.getElementById("tabs").getElementsByTagName("li").length; i++) {
						// document.getElementById("tabs").getElementsByTagName("li")[i].style.backgroundColor = "rgb(" + (197 -(20 * i)) + ", " + (113 -(11 * i)) + ", " + (128 -(13 * i)) + ")";
						document.getElementById("tabs").getElementsByTagName("li")[i].style.background = "";
					}
				} else {
					document.getElementById("tabs").classList.add('colored');
				}
				if ( localStorage.setting_showIcons == "true" ) {
					for (i=0; i<document.getElementById("main-screen-content").getElementsByClassName("tab-icon").length; i++) {
						document.getElementById("main-screen-content").getElementsByClassName("tab-icon")[i].style.display = "";
					}
				} else {
					for (i=0; i<document.getElementById("main-screen-content").getElementsByClassName("tab-icon").length; i++) {
						document.getElementById("main-screen-content").getElementsByClassName("tab-icon")[i].style.display = "none";
					}
				}
				if ( localStorage.setting_whiteTheme == "true" ) {
					document.body.classList.remove('dark');
					document.body.classList.add('white');
					console.log('Changint to White Theme');
				} else {
					document.body.classList.remove('white');
					document.body.classList.add('dark');
					console.log('Changint to Dark Theme')
				}
			}
			
			// INITIATE FUNCTION BEGIN
			function initiate() {
				console.log('INITIATING APP...');
				checkSettings();
				getXMLDocument("./weather/" + localStorage.setting_country + "/" + localStorage.setting_town + ".xml", parseBoolean(localStorage.setting_showColors), parseBoolean(localStorage.setting_shortify));
			}
			// INITIATE FUNCTION END
			
		</script>
		<!-- MAIN SCRIPTS END-->
		
	</body>
</html>